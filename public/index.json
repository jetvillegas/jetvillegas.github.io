[{"content":"\u003cp\u003eI am a builder, operator, and investor in the technology industry. I’ve worked on many successful commercial and free products: games, tools, runtimes, operating systems, browsers, programming languages, servers, distributed systems, mobile and web applications. I may have code running on your device right now.\u003c/p\u003e\n\u003cp\u003eMy mission is to advance the human condition via technology. I operate on a global scale with a keen eye for the critical details. If you would like to work with me, I am \u003ca href=\"https://www.linkedin.com/in/jetvillegas/\"\u003eoften hiring\u003c/a\u003e. If you would like me to invest funding or work on your project, please send an \u003ca href=\"mailto:jet@junglecode.net\"\u003eemail\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eSpecialties: Product \u0026amp; Engineering Management, Interactive Media, Graphics, Video, Sound, Text, Distributed Systems, Search, Advertising, Data Science, Security, Compilers, Debuggers, Licensing, Browsers, Servers, Mobile, VR, Web/Machine, Application and System Software.\u003c/p\u003e\n","description":null,"image":"http://jetvillegas.com/wp-content/uploads/sites/5/2022/04/ATGF3306-825x510.jpg","permalink":"http://localhost:57141/2022/04/09/jet-villegas/","title":"About Me"},{"content":"\u003cp\u003eI’ve been teaching people about Search Advertising lately, and I use the Lucene project to demonstrate indexing, searching, relevance, ranking, scoring, and boosting. It’s a little tricky to set up with some gotchas with build and runtime setup. I’m posting here so I can tell students where to look.\u003c/p\u003e\n\u003cp\u003eThis tutorial assumes a clean Ubuntu Linux 20.04 LTS system. We’ll put developer dependencies into a \u003ccode\u003edev\u003c/code\u003e folder on the user’s home directory:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emkdir ~/dev\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;cd ~/dev\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eSet up \u003ca href=\"https://www.digitalocean.com/community/tutorials/how-to-install-java-with-apt-on-ubuntu-20-04\"\u003eJAVA\u003c/a\u003e.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo apt install default-jre\nsudo apt install default-jdk\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSet up \u003ca href=\"https://ant.apache.org/bindownload.cgi\"\u003eAnt\u003c/a\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget https://ftp.jaist.ac.jp/pub/apache//ant/binaries/apache-ant-1.10.10-bin.tar.gz\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;tar -zxvf ./apache-ant-1.10.10-bin.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eEdit our shell environment for Java. Add these to your shell’s configuration\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eJAVA_HOME=\u0026#34;/usr/lib/jvm/java-11-openjdk-amd64\u0026#34;\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;ANT_HOME=\u0026#34;/home/jet/dev/apache-ant-1.10.10\u0026#34;\npath+=(${ANT_HOME}\u0026#39;/bin\u0026#39;)\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;export PATH\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eWe’ll set up \u003ca href=\"https://lucene.apache.org/core/downloads.html\"\u003eLucene\u003c/a\u003e into a \u003ccode\u003esrc\u003c/code\u003e folder in the user’s home directory:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkdir ~/src\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;cd ~/src\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;wget https://ftp.riken.jp/net/apache/lucene/java/8.9.0/lucene-8.9.0-src.tgz\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;tar -zxvf lucene-8.9.0-src.tgz \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBuild Lucine. Note the specific \u003ccode\u003eant ivy\u003c/code\u003e setup it requires:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecd ~/src/lucene-8.9.0\nant ivy-bootstrap\u0026lt;br\u0026gt;\u0026lt;/br\u0026gt;ant jar -Dversion=8.9.0\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eRun the Lucene \u003ca href=\"https://lucene.apache.org/core/8_9_0/demo/index.html\"\u003eDemo\u003c/a\u003e. Note the classpath requires 4 specific paths to include. Mistakes here will cause the \u003ccode\u003eorg.apache.lucene.analysis.standard.StandardAnalyzer\u003c/code\u003e not found error:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#replace user with your username  \njava -cp \u0026#34;/home/user/src/lucene-8.9.0/build/core/:/home/jet/src/lucene-8.9.0/build/queryparser/:/home/user/src/lucene-8.9.0/build/analysis/common/:/home/user /src/lucene-8.9.0/build/demo/\u0026#34; java org.apache.lucene.demo.IndexFiles -docs ~/src/lucene-8.9.0\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eRun the Lucene search engine through its own source files:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ejava -cp \u0026#34;/home/user/src/lucene-8.9.0/build/core/:/home/jet/src/lucene-8.9.0/build/queryparser/:/home/`user`/src/lucene-8.9.0/build/analysis/common/:/home/`user`/src/lucene-8.9.0/build/demo/\u0026#34;``` org.apache.lucene.demo.SearchFiles`\n\u003c/code\u003e\u003c/pre\u003e","description":null,"image":null,"permalink":"http://localhost:57141/2021/07/05/running-the-lucene-8-9-0-demo-on-ubuntu-20-04-lts/","title":"Running the Lucene 8.9.0 Demo on Ubuntu 20.04 LTS"},{"content":"\u003cp\u003eI run many virtual machines on KVM and VirtualBox. I typically clone an existing VM that is already set up for the project or service I’m working on. These are the steps I take on KVM on Linux (Ubuntu) hosts to clone and deploy a guest VM.\u003c/p\u003e\n\u003ch3 id=\"on-the-host\"\u003eOn the host\u003c/h3\u003e\n\u003cp\u003eSuspend the VM you’re copying\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo virsh shutdown source_VM\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eClone the source VM with a new name\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo\u003c/code\u003e \u003ccode\u003evirt-clone --original source_VM --name destination_VM --file /var/lib/libvirt/images/destination_VM.qcow2\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eStart the source VM back up\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo\u003c/code\u003e \u003ccode\u003evirsh start source_VM\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003ePrepare the new VM for service\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo virt-sysprep -d destination_VM --hostname destination_VM --enable customize,user-account,ssh-hostkeys,net-hostname,net-hwaddr,machine-id --keep-user-accounts your_username --keep-user-accounts root\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eStart the new VM\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo virsh start destination_VM\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"on-the-guest\"\u003eOn the guest\u003c/h3\u003e\n\u003cp\u003eFix up SSH\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo dpkg-reconfigure openssh-server\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eRestart the guest\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esudo reboot\u003c/code\u003e\u003c/p\u003e\n","description":null,"image":null,"permalink":"http://localhost:57141/2021/07/04/cloning-virtual-machines-in-kvm/","title":"Cloning Virtual Machines in KVM"},{"content":"\u003cp\u003eIn this post, I describe how to migrate media from one Plex server to a new server installation. The \u003ca href=\"https://support.plex.tv/articles/201370363-move-an-install-to-another-system/\"\u003eofficial Plex documentation\u003c/a\u003e on how to do this leaves out several critical details that I’ll cover here. If you’ve somehow lost the server configuration options from your new install, I’ll show you how to fix that below.\u003c/p\u003e\n\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/no_server_options-1024x897.png)\u003c/figure\u003e## Prepare the Source Server\n\u003cp\u003eI’m moving from one Linux installation (Ubuntu 18.04.5 LTS) to another (Ubuntu 20.04.2 LTS.) I’m also moving from a bare metal server to a KVM virtual machine but these instructions should work (with some platform-specific adjustments) for your system.\u003c/p\u003e\n\u003cp\u003eThe first thing to do is to sign out of the server you’re migrating from. We’ll call this the \u003cem\u003esource\u003c/em\u003e server.\u003c/p\u003e\n\u003cfigure class=\"wp-block-image size-large\"\u003e![](http://jetvillegas.com/wp-content/uploads/sites/5/2021/06/settings_button.png)\u003cfigcaption\u003eClick on the Settings button in Plex to get to the server configuration options.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/sign_out_server-1024x923.png)\u003cfigcaption\u003eClick Settings \u0026gt; General \u0026gt; Sign Out on the source server.\u003c/figcaption\u003e\u003c/figure\u003eNext, we’ll stop the Plex Media Server service on the source server. On Linux, you do this with:\n\u003cp\u003e\u003ccode\u003e$ sudo service plexmediaserver stop\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThis will differ on Windows or Mac, but same idea.\u003c/p\u003e\n\u003cp\u003eConfirm that the service is stopped on the source server. Again, this will differ on Windows or Mac, but same idea:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo service plexmediaserver status\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eMove the media files to the new location. You can move the files any way you like, but I personally use rsync for its fault tolerance and how it correctly preserves file permissions.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo rsync -zarvh --progress you@source_server:/path/to/your/source/plex/media/ /path/to/your/plex/destination/media\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eNote the trailing / on the source directory will copy the contents of the media folder into a new folder named media on the destination. Depending on how much media you have, this can take a while.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"prepare-the-destination-server\"\u003ePrepare the Destination Server\u003c/h2\u003e\n\u003cp\u003eInstall Plex Media Server on the \u003cem\u003edestination\u003c/em\u003e server. \u003ca href=\"https://www.plex.tv/media-server-downloads/\"\u003eDownload the latest version\u003c/a\u003e from Plex and follow the installation steps for your server platform.\u003c/p\u003e\n\u003cp\u003eFor Plex to work, it must have access over TCP port 32400. If you run a firewall, you’ll need to allow that:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo ufw allow 32400\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eStart the Plex Media Server service on the destination server:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo service plexmediaserver start\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eCheck that it’s running OK:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo service plexmediaserver status\u003c/code\u003e\u003c/p\u003e\n\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/server_status-1024x296.png)\u003cfigcaption\u003eIf all’s well, you should see it running on the destination server\u003c/figcaption\u003e\u003c/figure\u003eNote where Plex installs itself and its configuration files. On Linux, it’s installed here:\n\u003cp\u003eServer Config: \u003ccode\u003e/var/lib/plexmediaserver/Library/Application Support/Plex Media Server\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eServer Install: \u003ccode\u003e/usr/lib/plexmediaserver\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e The Plex Media Server runs as the user \u003ccode\u003eplex\u003c/code\u003e by default. The \u003ccode\u003eplex\u003c/code\u003e user must have read and execute permissions to your media directories and files. Verify that there is a \u003ccode\u003eplex\u003c/code\u003e user on your system. On Linux, you can check the \u003ccode\u003epasswd\u003c/code\u003e file for a user named \u003ccode\u003eplex\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ less /etc/passwd\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eTo complete the migration you must log into the destination server on \u003ccode\u003elocalhost\u003c/code\u003e. It’s important that you do this with a web browser by typing \u003ccode\u003ehttp://localhost:32400/web\u003c/code\u003e on the address bar. If you skip this step, you will have missing server options and no access to your media libraries. You have to complete the installation on \u003ccode\u003elocalhost\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIf you installed Plex Media Server on a headless server with no local web access, you have to tunnel into the destination server from your local machine. This tricks Plex into thinking you’re logging in from localhost.\u003c/p\u003e\n\u003cp\u003eWe’ll tunnel over port \u003ccode\u003e8888\u003c/code\u003e. On Linux you do this over SSH. If you have a Firewall running, you’ll need to allow port \u003ccode\u003e8888\u003c/code\u003e:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo ufw allow 8888\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eNext, SSH into the destination server:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ ssh you@ip.address.of.server -L 8888:localhost:32400\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eOn your local computer, type \u003ccode\u003ehttp://localhost:8888/web\u003c/code\u003e on your browser’s address bar to continue.\u003c/p\u003e\n\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_first_sign_in-1024x933.png)\u003cfigcaption\u003eSign into the destination server on `localhost` using your Plex email and password.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_friendly_name-1012x1024.jpg)\u003cfigcaption\u003eGive your server a friendly name.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_got_it-928x1024.png)\u003cfigcaption\u003eAfter naming your destination server, Plex will offer up options for re-adding your media libraries.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media-1024x958.png)\u003cfigcaption\u003eClick Add Library to start adding back your media files on the destination server.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media_add_library-1024x745.png)\u003cfigcaption\u003ePick a Library type depending on the files you’re adding back.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media_add_movies-1024x738.png)\u003cfigcaption\u003eBrowse for the folder on your destination server that contains the Library’s files.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media_add_movies_2-1024x797.png)\u003cfigcaption\u003eLibraries you add get added to the list that Plex will index and process.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media_finished-1024x969.jpg)\u003cfigcaption\u003eClick Done after you’ve finished adding Libraries.\u003c/figcaption\u003e\u003c/figure\u003e\u003cfigure class=\"wp-block-image size-large\"\u003e![](https://jetvillegas.com/wp-content/uploads/sites/5/2021/06/localhost_8888_organize_media_revealed-717x1024.png)\u003cfigcaption\u003eYou’ll now see all your media in the Libraries listed below the default ones. \u003c/figcaption\u003e\u003c/figure\u003e- - - - - -\n\u003ch2 id=\"cleaning-up\"\u003eCleaning Up\u003c/h2\u003e\n\u003cp\u003eIf you had to tunnel into your server’s firewall, remove port \u003ccode\u003e8888\u003c/code\u003e after you’re done\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$ sudo ufw delete allow 8888/tcp\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eI personally like running Plex over https. I also dislike using port 32400 so I set it up with nginx as a reverse proxy. That’s outside the scope of this post, but \u003ca href=\"https://github.com/toomuchio/plex-nginx-reverseproxy\"\u003ehere’s a nice configuration file\u003c/a\u003e that I found on github for that purpose.\u003c/p\u003e\n","description":null,"image":null,"permalink":"http://localhost:57141/2021/06/27/plex-server-migration/","title":"Plex Server Migration"}]